<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="../../addons/breadcrumb/breadcrumb.css" />
		<link rel="stylesheet" type="text/css" href="../../addons/items/items.css" />
        <script type="text/javascript" src="../../src/js/jquery-1.6.1.min.js"></script>
        <script type="text/javascript" src="../../src/js/jKaiten.js"></script>
        <script type="text/javascript" src="../../addons/breadcrumb/breadcrumb.js"></script>
		<script type="text/javascript" src="../../addons/items/items.js"></script>
        <script type="text/javascript">
            (function (){
                
                var writers = {
                    asimov: {
                        fullname: 'Isaac Asimov',
                        books: [
                            {title: 'Robots'},
                            {title: 'Foundation'}
                        ]
                    },
                    tevis: {
                        fullname: 'Walter Tevis',
                        books: [
                            {title: "L'homme tombe du ciel"},
                            {title: "L'oiseau d'Amerique"}
                        ]
                    },
                    clarke: {
                        fullname: 'Arthur C. Clarke',
                        books: [
                            {title: "Rendez-vous avec Rama"},
                            {title: "La cite et les astres"}
                        ]
                    },
                    devitt: {
                        fullname: 'Jack McDevitt',
                        books: [
                            {title: "Les machines de Dieu"},
                            {title: "Deepsix"},
                            {title: "Chindi"},
                            {title: "Omega"}
                        ]
                    }
                };                                
                
                //This is my own loader                
                function Panel(elt){
                    //It takes from the elt the panel to load.
                    var p = elt.data('panel');
                    //Then it checks if it has that panel in its property
                    if (!p || !Panel.hasOwnProperty(p)){
                        $.error("Panel '"+p+"' Not Found");                        
                    }                    
                    //Calling that panel
                    Panel[p](elt);
                }
                
                //This is the home panel
                Panel.home = function (elt){
                    var items = $('<ol class="k-items"/>'),
                        item;
                    
                    $.map(writers, function (val, key){
                        
                        item = $([
                            '<li class="k-item nav">',
                            '   <span class="k-left k-title">' + val.fullname + '</span>',
                            '</li>'
                        ].join(''));
                        
                        item.data({
                            panel:  'writer',
                            writer: key,
                            title:  val.fullname
                        });
                        
                        items.append(item);
                        
                    });
                                        
                    $.kaiten(items, elt.getPanelTitle());
                };
                
                //This lists the books of given writer
                Panel.writer = function (elt){
                    var w     = elt.data('writer'),
                        i     = 0,
                        n     = writers[w].books.length,
                        items = $('<ol class="k-items"/>');
                        
                    for (; i<n; i++){
                        items.append([
                            '<li class="k-item nav">',
                            '   <span class="k-left k-title">' + writers[w].books[i].title + '</span>',
                            '</li>'
                        ].join(''));                        
                    }
                    
                    $.kaiten(items, elt.getPanelTitle());
                };
                
                //Setting my own loader
                $.kaiten.configure({loader: Panel});
                
            }());
        </script>
        <title>jKaiten Demo</title>
    </head>
    <body data-panel="home" data-title="Sci-fi Writers"></body>
</html>
