/*********************************************************************************
 * jQuery.folderPreview (v1.0 | 2011 04 23)                                      *
 * A jQuery plugin that positions thumbnails to appear inside a folder graphic.  *
 *                                                                               *
 * Copyright 2011 Aisa Development (http://www.aisadevelopment.com/).            *
 * Licensed under CC BY-SA 3.0 (http://creativecommons.org/licenses/by-sa/3.0/). *
 *********************************************************************************/
(function($){$.fn.extend({folderPreview:function(options){var defaults={imageWidth:45,imageHeight:45,imagesMax:3,imagesShuffle:true,imageMinRotate:-70,imageMaxRotate:+70,imageMinYOffset:0,imageMaxYOffset:5,imageMinXOffset:35,imageMaxXOffset:45,imageZIndex:1,imageSelector:'img',imagesAreChildren:true,imageContainer:'',folderWidth:128,folderHeight:128,folderImageURL:'folder.png',backHeight:33,frontContent:'',frontContentClass:'fP-front',imageRotateExpr:'Math.random()*(options.imageMaxRotate-options.imageMinRotate)+options.imageMinRotate',imageTopExpr:'(Math.random()*(options.imageMaxYOffset-options.imageMinYOffset)+options.imageMinYOffset)+"px"',imageLeftExpr:'(i*(Math.random()*(options.imageMaxXOffset-options.imageMinXOffset)+options.imageMinXOffset)+(options.folderWidth/2-len*options.imageWidth/2))+"px"',imageCSS:'{position: "absolute", top: eval(options.imageTopExpr), left: eval(options.imageLeftExpr), zIndex: options.imageZIndex}',folderCSS:'{position: "relative", width: options.folderWidth+"px", height: options.folderHeight+"px", background: "url(\'"+options.folderImageURL+"\') no-repeat center bottom"}',frontCSS:'{position: "absolute", top: options.backHeight+"px", left: "0", width: options.folderWidth+"px", height: (options.folderHeight-options.backHeight)+"px", background: "url(\'"+options.folderImageURL+"\') no-repeat center bottom", zIndex: options.imageZIndex+1}',onComplete:function(){}},options=$.extend(defaults,options);if(!options.imagesAreChildren)$(this).append($('#'+options.imageContainer).html());if(options.imagesShuffle)this.children(options.imageSelector).shuffle();this.children(options.imageSelector+':gt('+(options.imagesMax-1)+')').remove();var arr=this.children(options.imageSelector),len=arr.length;arr.each(function(i){$(this).rotate(eval('('+options.imageRotateExpr+')'));$(this).one('load',function(){if($(this).width()>options.imageWidth||$(this).height()>options.imageHeight)$(this).width(options.imageWidth).height(options.imageHeight/($(this).width()/$(this).height()));}).each(function(){if(this.complete)$(this).trigger('load');});$(this).css(eval('('+options.imageCSS+')'));});var front=$('<div />').css(eval('('+options.frontCSS+')'));$('<div />').addClass(options.frontContentClass).html(options.frontContent).appendTo(front);front.appendTo(this);this.css(eval('('+options.folderCSS+')'));options.onComplete();return this;}});})(jQuery);




/**
 * jQuery Shuffle (http://mktgdept.com/jquery-shuffle)
 * A jQuery plugin for shuffling a set of elements
 *
 * v0.0.1 - 13 November 2009
 *
 * Copyright (c) 2009 Chad Smith (http://twitter.com/chadsmith)
 * Dual licensed under the MIT and GPL licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/gpl-license.php
 *
 * Shuffle elements using: $(selector).shuffle() or $.shuffle(selector)
 *
 **/
(function(d){d.fn.shuffle=function(c){c=[];return this.each(function(){c.push(d(this).clone(true))}).each(function(a,b){d(b).replaceWith(c[a=Math.floor(Math.random()*c.length)]);c.splice(a,1)})};d.shuffle=function(a){return d(a).shuffle()}})(jQuery);




// VERSION: 1.8 LAST UPDATE: 9.03.2011
/* 
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 * 
 * Made by Wilq32, wilq32@gmail.com, Wroclaw, Poland, 01.2009
 * Website: http://code.google.com/p/jqueryrotate/ 
 */
(function($){var supportedCSS,styles=document.getElementsByTagName("head")[0].style,toCheck="transformProperty WebkitTransform OTransform msTransform MozTransform".split(" ");for(var a=0;a<toCheck.length;a++){if(styles[toCheck[a]]!==undefined){supportedCSS=toCheck[a]}}var IE=eval('"v"=="\v"');jQuery.fn.extend({ImageRotate:function(parameters){if(this.Wilq32&&this.Wilq32.PhotoEffect){return}var paramClone=$.extend(true,{},parameters);return(new Wilq32.PhotoEffect(this.get(0),paramClone))._rootObj},rotate:function(parameters){if(this.length===0||typeof parameters=="undefined"){return}if(typeof parameters=="number"){parameters={angle:parameters}}var returned=[];for(var i=0,i0=this.length;i<i0;i++){var element=this.get(i);if(typeof element.Wilq32=="undefined"){returned.push($($(element).ImageRotate(parameters)))}else{element.Wilq32.PhotoEffect._handleRotation(parameters)}}return returned}});Wilq32=window.Wilq32||{};Wilq32.PhotoEffect=(function(){if(supportedCSS){return function(img,parameters){img.Wilq32={PhotoEffect:this};this._img=this._rootObj=this._eventObj=img;this._handleRotation(parameters)}}else{return function(img,parameters){this._img=img;this._rootObj=document.createElement("span");this._rootObj.style.display="inline-block";this._rootObj.Wilq32={PhotoEffect:this};img.parentNode.insertBefore(this._rootObj,img);if(img.complete){this._Loader(parameters)}else{var self=this;jQuery(this._img).bind("load",function(){self._Loader(parameters)})}}}})();Wilq32.PhotoEffect.prototype={_setupParameters:function(parameters){this._parameters=this._parameters||{};if(typeof this._angle!=="number"){this._angle=0}if(typeof parameters.angle==="number"){this._angle=parameters.angle}this._parameters.animateTo=(typeof parameters.animateTo==="number")?(parameters.animateTo):(this._angle);this._parameters.easing=parameters.easing||this._parameters.easing||function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b};this._parameters.duration=parameters.duration||this._parameters.duration||1000;this._parameters.callback=parameters.callback||this._parameters.callback||function(){};if(parameters.bind&&parameters.bind!=this._parameters.bind){this._BindEvents(parameters.bind)}},_handleRotation:function(parameters){this._setupParameters(parameters);if(this._angle==this._parameters.animateTo){this._rotate(this._angle)}else{this._animateStart()}},_BindEvents:function(events){if(events&&this._eventObj){if(this._parameters.bind){var oldEvents=this._parameters.bind;for(var a in oldEvents){if(oldEvents.hasOwnProperty(a)){jQuery(this._eventObj).unbind(a,oldEvents[a])}}}this._parameters.bind=events;for(var a in events){if(events.hasOwnProperty(a)){jQuery(this._eventObj).bind(a,events[a])}}}},_Loader:(function(){if(IE){return function(parameters){var width=this._img.width;var height=this._img.height;this._img.parentNode.removeChild(this._img);this._vimage=this.createVMLNode("image");this._vimage.src=this._img.src;this._vimage.style.height=height+"px";this._vimage.style.width=width+"px";this._vimage.style.position="absolute";this._vimage.style.top="0px";this._vimage.style.left="0px";this._container=this.createVMLNode("group");this._container.style.width=width;this._container.style.height=height;this._container.style.position="absolute";this._container.setAttribute("coordsize",width-1+","+(height-1));this._container.appendChild(this._vimage);this._rootObj.appendChild(this._container);this._rootObj.style.position="relative";this._rootObj.style.width=width+"px";this._rootObj.style.height=height+"px";this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._eventObj=this._rootObj;this._handleRotation(parameters)}}else{return function(parameters){this._rootObj.setAttribute("id",this._img.getAttribute("id"));this._rootObj.className=this._img.className;this._width=this._img.width;this._height=this._img.height;this._widthHalf=this._width/2;this._heightHalf=this._height/2;var _widthMax=Math.sqrt((this._height)*(this._height)+(this._width)*(this._width));this._widthAdd=_widthMax-this._width;this._heightAdd=_widthMax-this._height;this._widthAddHalf=this._widthAdd/2;this._heightAddHalf=this._heightAdd/2;this._img.parentNode.removeChild(this._img);this._aspectW=((parseInt(this._img.style.width,10))||this._width)/this._img.width;this._aspectH=((parseInt(this._img.style.height,10))||this._height)/this._img.height;this._canvas=document.createElement("canvas");this._canvas.setAttribute("width",this._width);this._canvas.style.position="relative";this._canvas.style.left=-this._widthAddHalf+"px";this._canvas.style.top=-this._heightAddHalf+"px";this._canvas.Wilq32=this._rootObj.Wilq32;this._rootObj.appendChild(this._canvas);this._rootObj.style.width=this._width+"px";this._rootObj.style.height=this._height+"px";this._eventObj=this._canvas;this._cnv=this._canvas.getContext("2d");this._handleRotation(parameters)}}})(),_animateStart:function(){if(this._timer){clearTimeout(this._timer)}this._animateStartTime=+new Date;this._animateStartAngle=this._angle;this._animate()},_animate:function(){var actualTime=+new Date;var checkEnd=actualTime-this._animateStartTime>this._parameters.duration;if(checkEnd&&!this._parameters.animatedGif){clearTimeout(this._timer)}else{if(this._canvas||this._vimage||this._img){var angle=this._parameters.easing(0,actualTime-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate((~~(angle*10))/10)}var self=this;this._timer=setTimeout(function(){self._animate.call(self)},10)}if(this._parameters.callback&&checkEnd){this._angle=this._parameters.animateTo;this._rotate(this._angle);this._parameters.callback.call(this._rootObj)}},_rotate:(function(){var rad=Math.PI/180;if(IE){return function(angle){this._angle=angle;this._container.style.rotation=(angle%360)+"deg"}}else{if(supportedCSS){return function(angle){this._angle=angle;this._img.style[supportedCSS]="rotate("+(angle%360)+"deg)"}}else{return function(angle){this._angle=angle;angle=(angle%360)*rad;this._canvas.width=this._width+this._widthAdd;this._canvas.height=this._height+this._heightAdd;this._cnv.translate(this._widthAddHalf,this._heightAddHalf);this._cnv.translate(this._widthHalf,this._heightHalf);this._cnv.rotate(angle);this._cnv.translate(-this._widthHalf,-this._heightHalf);this._cnv.scale(this._aspectW,this._aspectH);this._cnv.drawImage(this._img,0,0)}}}})()};if(IE){Wilq32.PhotoEffect.prototype.createVMLNode=(function(){document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!document.namespaces.rvml&&document.namespaces.add("rvml","urn:schemas-microsoft-com:vml");return function(tagName){return document.createElement("<rvml:"+tagName+' class="rvml">')}}catch(e){return function(tagName){return document.createElement("<"+tagName+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}})()}})(jQuery);