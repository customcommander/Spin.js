<!DOCTYPE html>
<html>
    <head>
        <title>Spin.js QUnit Tests</title>
        <link rel="stylesheet" type="text/css" href="qunit/qunit-git.css"/>		
		<link rel="stylesheet" type="text/css" href="../addons/breadcrumb/breadcrumb.css" />
		<link rel="stylesheet" type="text/css" href="../addons/items/items.css" />
		
		<style type="text/css">
		    #qunit-console{
		        position: absolute;
		        top: 0;
		        right: 0;
		        bottom: 0;
		        overflow-y: auto;
		        z-index:200;
		    }
		    .block {
		        margin: 2em;
		    }
		</style>
		
        <script type="text/javascript" src="../src/js/jquery-1.6.1.min.js"></script>        
        <script type="text/javascript" src="qunit/qunit-git.js"></script>
		<script type="text/javascript" src="../addons/breadcrumb/breadcrumb.js"></script>
		<script type="text/javascript" src="../addons/items/items.js"></script>
		<script type="text/javascript" src="../src/js/Spin.js"></script>
        <script type="text/javascript">   
        
            module('Init');         
            
            test('Torturing the default loader', function (){            
                //making jQuery objects with wrong values for data-url attribute
                var elts = [
                    $('<a></a>').data('url', null),             
                    $('<a></a>').data('url', undefined),
                    $('<a></a>').data('url', 0),                
                    $('<a></a>').data('url', 1),                
                    $('<a></a>').data('url', true),             
                    $('<a></a>').data('url', false),            
                    $('<a></a>').data('url', []),               
                    $('<a></a>').data('url', {}),               
                    $('<a></a>').data('url', '          '),     
                    $('<a></a>').data('url', '          '),
                    $('<a></a>').data('url', "\n"),
                    $('<a></a>').data('url', "\t"),
                    $('<a></a>').data('url', function(){})
                ];
                
                var i=0, n=elts.length;
                
                //testing with wrong values
                for (; i<n; i++){
                    raises(function(){ Env.loader( elts[i] ); }, 
                        'throw if no valid data-url attribute');                
                }
                
                //testing with no data-url attribute at all
                raises(function(){ Env.loader( $('<a></a>') ); }, 
                    'throw if no data-url attribute');                
            });
            
            $.holdReady(true);
            
            test('Torturing $.spin.configure()', function(){                
                //wrong arguments values for the function
                var wrong_args = [
                    null,
                    undefined,
                    [],
                    {},
                    true,
                    false,
                    0,
                    1,
                    -1,
                    Infinity,
                    -Infinity,
                    NaN,
                    'function'
                ];
                
                var i=0, n=wrong_args.length;
                
                //testing the function with wrong arguments
                for (; i<n; i++){
                    raises(function(){ $.spin.configure( wrong_args[i] ); }, 
                        'throw if arg is not a function');
                }
                
                //testing the function with no argument
                raises(function(){ $.spin.configure(); },
                    'throw if no arg');
                
                //testing the function with a valid argument
                ok($.spin.configure(Env.loader), 'arg is a function');
                
                $.holdReady(false);                               
            });            
            
            module('After Init');
            
            test('$.spin.configure', function(){
                function dummyfn(){}                
                raises(function(){ $.spin.configure( dummyfn )},
                    'throw if trying to configure after init');
            });
            
            
        </script>
    </head>
    <body data-url="index-tests.html" data-title="Home">
        <div id="qunit-console">
            <h1 id="qunit-header">QUnit Tests</h1>
            <h2 id="qunit-banner"></h2>
            <div id="qunit-testrunner-toolbar"></div>
            <h2 id="qunit-userAgent"></h2>
            <ol id="qunit-tests"></ol>
        </div>
    </body>
</html>
